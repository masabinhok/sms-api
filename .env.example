# =============================================================================
# SMS API - Environment Configuration Template
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit the .env file to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000

# -----------------------------------------------------------------------------
# JWT Authentication
# -----------------------------------------------------------------------------
# Generate secure secrets: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_ACCESS_SECRET=your-access-secret-here-min-32-chars
JWT_REFRESH_SECRET=your-refresh-secret-here-min-32-chars
JWT_ACCESS_EXPIRE=15m
JWT_REFRESH_EXPIRE=7d

# -----------------------------------------------------------------------------
# Kafka Configuration
# -----------------------------------------------------------------------------
# For local development (with docker-compose)
# NOTE: Use Docker service names (kafka1, kafka2, kafka3) for apps running in containers
KAFKA_BROKERS=kafka1:9092,kafka2:9092,kafka3:9092

# For production (use your Kafka cluster addresses)
# KAFKA_BROKERS=kafka1.prod.com:9092,kafka2.prod.com:9092,kafka3.prod.com:9092

KAFKA_CLIENT_ID=sms-api
KAFKA_REQUEST_TIMEOUT=5000
KAFKA_RETRY_ATTEMPTS=2
KAFKA_RETRY_DELAY=1000
KAFKA_CIRCUIT_BREAKER_THRESHOLD=5
KAFKA_CIRCUIT_BREAKER_TIMEOUT=60000

# -----------------------------------------------------------------------------
# Database URLs - PostgreSQL
# -----------------------------------------------------------------------------
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
# NOTE: Use 'postgres' as the host (Docker service name) for apps running in containers
#       The setup script will automatically create all databases

STUDENT_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sms_student
AUTH_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sms_auth
TEACHER_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sms_teacher
ACADEMICS_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sms_academics
ACTIVITY_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/sms_activity
ANNOUNCEMENT_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/announcement_sms

# -----------------------------------------------------------------------------
# Email Service Configuration (SMTP)
# -----------------------------------------------------------------------------
# For Gmail: Enable "Less secure app access" or use App Password
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# Email From Address
EMAIL_FROM=noreply@yourschool.com

# -----------------------------------------------------------------------------
# Frontend Configuration
# -----------------------------------------------------------------------------
# Frontend URL for CORS and redirects
FRONTEND_URL=http://localhost:4000

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins
CORS_ORIGINS=https://sms-nest.vercel.app,http://localhost:4000

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# Options: error, warn, log, debug, verbose
LOG_LEVEL=log

# -----------------------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------------------
# Memory threshold in bytes (default: 300MB)
HEALTH_MEMORY_HEAP_THRESHOLD=314572800

# Disk threshold in percentage (default: 90%)
HEALTH_DISK_THRESHOLD=0.9

# -----------------------------------------------------------------------------
# Production-Only Settings (Uncomment for production)
# -----------------------------------------------------------------------------

# Database Connection Pooling
# DATABASE_POOL_MIN=2
# DATABASE_POOL_MAX=10
# DATABASE_CONNECTION_TIMEOUT=30000

# Redis Cache (if implementing)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password

# Monitoring & Observability
# SENTRY_DSN=https://your-sentry-dsn
# PROMETHEUS_ENDPOINT=http://prometheus:9090

# Rate Limiting
# RATE_LIMIT_TTL=60
# RATE_LIMIT_MAX=100

# SSL/TLS for Production
# DATABASE_SSL=true
# KAFKA_SSL=true

# -----------------------------------------------------------------------------
# Setup Instructions
# -----------------------------------------------------------------------------
# 1. Copy this file: cp .env.example .env
#
# 2. Generate strong JWT secrets:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 3. Create PostgreSQL databases:
#    CREATE DATABASE sms_auth;
#    CREATE DATABASE sms_student;
#    CREATE DATABASE sms_teacher;
#    CREATE DATABASE sms_academics;
#    CREATE DATABASE sms_activity;
#
# 4. Update database credentials and other values
#
# 5. Run migrations:
#    npx prisma migrate deploy --schema=apps/auth/prisma/schema.prisma
#    (repeat for each service)
#
# 6. Start services: npm run dev